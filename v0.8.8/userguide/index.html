<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>User Guide · KernelFunctions</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">KernelFunctions</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>User Guide</a><ul class="internal"><li><a class="tocitem" href="#Kernel-creation"><span>Kernel creation</span></a></li><li><a class="tocitem" href="#Using-a-kernel-function"><span>Using a kernel function</span></a></li><li><a class="tocitem" href="#Creating-a-kernel-matrix"><span>Creating a kernel matrix</span></a></li><li><a class="tocitem" href="#Composite-kernels"><span>Composite kernels</span></a></li><li><a class="tocitem" href="#Kernel-Parameters"><span>Kernel Parameters</span></a></li></ul></li><li><a class="tocitem" href="../example/">Examples</a></li><li><a class="tocitem" href="../kernels/">Kernel Functions</a></li><li><a class="tocitem" href="../transform/">Transform</a></li><li><a class="tocitem" href="../metrics/">Metrics</a></li><li><a class="tocitem" href="../theory/">Theory</a></li><li><a class="tocitem" href="../create_kernel/">Custom Kernels</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>User Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>User Guide</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaGaussianProcesses/KernelFunctions.jl/blob/master/docs/src/userguide.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="User-guide"><a class="docs-heading-anchor" href="#User-guide">User guide</a><a id="User-guide-1"></a><a class="docs-heading-anchor-permalink" href="#User-guide" title="Permalink"></a></h1><h2 id="Kernel-creation"><a class="docs-heading-anchor" href="#Kernel-creation">Kernel creation</a><a id="Kernel-creation-1"></a><a class="docs-heading-anchor-permalink" href="#Kernel-creation" title="Permalink"></a></h2><p>To create a kernel chose one of the kernels proposed, see <a href="../kernels/#Base-Kernels">Base Kernels</a>, or create your own, see <a href="../create_kernel/#Creating-your-own-kernel">Creating your own kernel</a> For example to create a square exponential kernel</p><pre><code class="language-julia">  k = SqExponentialKernel()</code></pre><p>Instead of having lengthscale(s) for each kernel we use <code>Transform</code> objects (see <a href="../transform/#Transform">Transform</a>) which are directly going to act on the inputs before passing them to the kernel. For example to premultiply the input by 2.0 we create the kernel the following options are possible</p><pre><code class="language-julia">  k = transform(SqExponentialKernel(),ScaleTransform(2.0)) # returns a TransformedKernel
  k = @kernel SqExponentialKernel() l=2.0 # Will be available soon
  k = TransformedKernel(SqExponentialKernel(),ScaleTransform(2.0))</code></pre><p>Check the <a href="../api/#KernelFunctions.Transform"><code>Transform</code></a> page to see the other options. To premultiply the kernel by a variance, you can use <code>*</code> or create a <code>ScaledKernel</code></p><pre><code class="language-julia">  k = 3.0*SqExponentialKernel()
  k = ScaledKernel(SqExponentialKernel(),3.0)
  @kernel 3.0*SqExponentialKernel()</code></pre><h2 id="Using-a-kernel-function"><a class="docs-heading-anchor" href="#Using-a-kernel-function">Using a kernel function</a><a id="Using-a-kernel-function-1"></a><a class="docs-heading-anchor-permalink" href="#Using-a-kernel-function" title="Permalink"></a></h2><p>To compute the kernel function on two vectors you can call</p><pre><code class="language-julia">  k = SqExponentialKernel()
  x1 = rand(3)
  x2 = rand(3)
  k(x1,x2)</code></pre><h2 id="Creating-a-kernel-matrix"><a class="docs-heading-anchor" href="#Creating-a-kernel-matrix">Creating a kernel matrix</a><a id="Creating-a-kernel-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-kernel-matrix" title="Permalink"></a></h2><p>Kernel matrices can be created via the <code>kernelmatrix</code> function or <code>kerneldiagmatrix</code> for only the diagonal. An important argument to give is the dimensionality of the input <code>obsdim</code>. It tells if the matrix is of the type <code># samples X # features</code> (<code>obsdim</code>=1) or <code># features X # samples</code>(<code>obsdim</code>=2) (similarly to <a href="https://github.com/JuliaStats/Distances.jl">Distances.jl</a>) For example:</p><pre><code class="language-julia">  k = SqExponentialKernel()
  A = rand(10,5)
  kernelmatrix(k,A,obsdim=1) # Return a 10x10 matrix
  kernelmatrix(k,A,obsdim=2) # Return a 5x5 matrix
  k(A,obsdim=1) # Syntactic sugar</code></pre><p>We also support specific kernel matrices outputs:</p><ul><li>For a positive-definite matrix object<code>PDMat</code> from <a href="https://github.com/JuliaStats/PDMats.jl"><code>PDMats.jl</code></a>, you can call the following:</li></ul><pre><code class="language-julia">  using PDMats
  k = SqExponentialKernel()
  K = kernelpdmat(k,A,obsdim=1) # PDMat</code></pre><p>It will create a matrix and in case of bad conditionning will add some diagonal noise until the matrix is considered PSD, it will then return a <code>PDMat</code> object. For this method to work in your code you need to include <code>using PDMats</code> first</p><ul><li>For a Kronecker matrix, we rely on <a href="https://github.com/MichielStock/Kronecker.jl"><code>Kronecker.jl</code></a>. Here are two examples:</li></ul><pre><code class="language-julia">using Kronecker
x = range(0,1,length=10)
y = range(0,1,length=50)
K = kernelkronmat(k,[x,y]) # Kronecker matrix
K = kernelkronmat(k,x,5) # Kronecker matrix</code></pre><p>Make sure that <code>k</code> is a vector compatible with such constructions (with <code>iskroncompatible</code>). Both method will return a . For those methods to work in your code you need to include <code>using Kronecker</code> first</p><ul><li>For a Nystrom approximation : <code>kernelmatrix(nystrom(k, X, ρ, obsdim = 1))</code> where <code>ρ</code> is the proportion of sampled used.</li></ul><h2 id="Composite-kernels"><a class="docs-heading-anchor" href="#Composite-kernels">Composite kernels</a><a id="Composite-kernels-1"></a><a class="docs-heading-anchor-permalink" href="#Composite-kernels" title="Permalink"></a></h2><p>One can create combinations of kernels via <code>KernelSum</code> and <code>KernelProduct</code> or using simple operators <code>+</code> and <code>*</code>. For example :</p><pre><code class="language-julia">  k1 = SqExponentialKernel()
  k2 = Matern32Kernel()
  k = 0.5 * k1 + 0.2 * k2 # KernelSum
  k = k1 * k2 # KernelProduct</code></pre><h2 id="Kernel-Parameters"><a class="docs-heading-anchor" href="#Kernel-Parameters">Kernel Parameters</a><a id="Kernel-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Kernel-Parameters" title="Permalink"></a></h2><p>What if you want to differentiate through the kernel parameters? Even in a highly nested structure such as :</p><pre><code class="language-julia">  k = transform(0.5*SqExponentialKernel()*MaternKernel()+0.2*(transform(LinearKernel(),2.0)+PolynomialKernel()),[0.1,0.5])</code></pre><p>One can get the array of parameters to optimize via <code>params</code> from <code>Flux.jl</code></p><pre><code class="language-julia">  using Flux
  params(k)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../example/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 30 November 2020 12:55">Monday 30 November 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
